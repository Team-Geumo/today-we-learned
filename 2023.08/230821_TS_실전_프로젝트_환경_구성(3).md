# 19. 실전 프로젝트 환경 구성 (3)

## 19.5. 타입스크립트 설정 파일과 빌드 도구

- 타입스크립트를 사용하는 대부분의 프로젝트는 리액트(React)나 뷰(Vue.js) 같은 프런트엔드 개발 프레임워크와 웹팩(Webpack) 또는 롤업(rollup)이라는 빌드 도구 사용
- 타입스크립트는 패키지 관리 도구인 NPM으로 설치하고 빌드(컴파일)하는 과정이 필요하기 때문
- 실무 프로젝트에서는 단순히 타입스크립트만 빌드하지 않고 다음 과정을 모두 하나의 빌드 과정에 포함시킴
  - **파일 변환**: ts 파일을 js 파일로 변환하거나, 최신 js 문법을 예전 js 문법으로 변환하거나, scss 파일을 css 파일로 변환하는 등 빌드 직압얼 의미
  - **파일 압축**: 페이지 로딩 속도를 높이려고 파일을 압축하여 용량을 줄임
  - **파일 병합**: 여러 개의 파일을 하나의 파일로 병합하여 네트워크 요청 시간 줄임
- 사용자에게 제공되는 웹 서비스 프로젝트는 대부분 웹팩 사용
- 웹팩이 프런트엔드 개발 주류 프레임워크인 뷰나 리액트의 기본 권장 도구로 설정되어 있기 때문

<br>

### 19.5.1. 웹팩이란?

- **모듈 번들러(module bundler)** 이자 프런트엔드 개발 빌드 도구
- 파일 여러 개와 모듈을 다루는 실무 프로젝트에서 거의 필수로 사용하는 도구
- 모듈 번들러는 여러 개의 묘듈을 하나의 모듈로 병햡해 준다는 의미

<br>

- 웹 애플리케이션을 구성하는 리소스를 웹팩으로 빌드하면 정적 자원이 나옴
  - 여러 개의 파일을 하나로 병합하고 웹 서버에 바로 올려서 사용자들이 접근할 수 있는 형태의 파일로 변환해 줌

<br>

### 19.5.2. 웹팩에 타입스크립트 설정하기

- 웹팩 기반의 웹 애플리케이션 프로젝트에서 타입스크립트 파일을 사용하려면 웹팩 설정 파일 작성 필요

  ```javascript
  // webpack.config.js
  const path = require("path");

  module.exports = {
    entry: "./src/index.ts",
    module: {
      rules: [
        {
          test: /\.tsx?$/,
          use: "ts-loader",
          exclude: /node_modules/,
        },
      ],
    },
    resolve: {
      extensions: [".tsx", ".ts", ".js"],
    },
    output: {
      filename: "bundle.js",
      path: path.resolve(__dirname, "dist"),
    },
  };
  ```

  - 리액트나 뷰 같은 프런트엔드 개발 프레임워크를 사용하면 직접 작성할 필요 없음
    - CRA(Create React App)나 CNA(Createt Next App), Vue CLI처럼 프로젝트 생성 도구로 프로젝트를 생성했을 때 내부에 이미 다 정의되어 있기 때문

- `entry`
  - 웹팩의 진입점 의미
  - 웹팩 빌드 명령어를 실행했을 때 대상이 되는 파일 경로 지정
- `module`
  - 웹팩의 로더(loader) 의미
  - 자바스크립트 파일을 제외한 css, jpg, ttf 파일들을 모듈로 취급하려면 로더를 설정해 주어야 함
  - 타입스크립트 파일 역시 자바스크립트 파일이 아니기 때문에 `ts-loader`를 설정해줌
- `resolve`

  - 웹팩의 모듈 해석 방식 정의
  - `extensions`에 적힌 파일 확장자는 `import` 구문을 사용할 때 파일 확장자를 적지 않아도 인식하겠다는 의미

  ```typescript
  // extensions 옵션 적용 전
  import { sum } from "./math.ts";

  // extensions 옵션 적용 후
  import { sum } from "./math";
  ```

- `output`
  - 웹팩으로 빌드된 결과물에 대한 설정
  - 빌드된 파일은 `bundle.js`고, 빌드된 파일 경로는 `dist` 폴더 아래

<br><br>

## 19.6. 타입 선언 파일

- 타입 선언 파일은 `d.ts` 확장자를 갖는 타입스크립트 파일 의미
- 프로젝트에서 자주 사용되는 공통 타입이나 프로젝트 전반에 걸쳐 사용하는 라이브러리 타입을 정의하는 공간

<br>

### 19.6.1. 타입 선언 파일 사용 방법

- 프로젝트 루트 레벨에 정의해 놓으면 자동으로 프로젝트 내 타입스크립트 파일에서 해당 파일 인식함

```typescript
// project.d.ts
interface Product {
  name: string;
  id: string;
}

// index.ts
const shirts: Product = {
  name: "와이셔츠",
  id: "1",
};
```

- 타입 선언 파일은 `d.ts` 확장자로 선언하기 때문에 선언되면 바로 타입스크립트 프로젝트에서 해당 타입 선언 파일의 타입들을 인식
- `index.ts` 파일처럼 별도로 타입을 임포트하지 않아도 사용 가능

<br>

### 19.6.2. 타입 선언 파일을 언제 사용해야 하는가?

- 타입 선언 파일을 사용하면 타입스크립트 파일에 타입 코드를 작성하지 않고 다른 파일에 분리해 놓을 수 있음
- 타입 선언 파일을 생성하지 않았다면 `index.ts` 파일에 타입 코드와 로직 코드가 들어가 있음

```typescript
// index.ts
export interface Product {
  name: string;
  id: string;
}

const shirts: Product = {
  name: "와이셔츠",
  id: "1",
};

// list.ts
import { Product } from "./index";

const pants: Product = {
  name: "팬츠",
  id: "2",
};
```

- 다른 파일에서도 `Product` 타입을 사용한다면 타입 앞에 `export` 구문을 추가하고, 타입을 사용하려는 파일 위에 `import` 구문으로 타입을 가져와야 함
- 프로젝트 내 공통 타입들은 별도의 타입스크립트 파일에 정의 가능

  ```typescript
  // types.ts
  export interface Product {
    name: string;
    id: string;
  }
  ```

- `types`파는 타입스크립트 파일에는 프로젝트 내 공통 타입만 정의한다고 가정하고 타입 선언 코드만 작성 가능
- 나중에 누군가가 로직을 추가하고자 할 때 그렇게 작성하지 못하도록 시스템적으로 강제할 수 없음

  ```typescript
  // types.ts
  export interface Product {
    name: string;
    id: string;
  }

  function printProduct() {
    // ...
  }
  ```

<br>

- **타입 선언 파일: 자주 사용되는 공통 타입을 별도로 익스포트하거나 임포트하지 않고 프로젝트 레벨에서 자동으로 인식하게 할 수 있는 방법**

<br><br>

## 19.7. 외부 라이브러리의 타입 선언과 활용

- 외부 라이브러리
  - 웹 서비스 개발에 필요한 NPM 패키지들
  - jQuery, 리액트, 뷰, ESLint, Prettier, DataTable, Jest, Swiper.js 등 화면 로직 개발에 도움을 주거나 문법 검사 도구로 쓰이는 등 개발 전반에 걸쳐 사용되고 있음

<br>

### 19.7.1. 외부 라이브러리를 사용하는 방법

- 타입스크립트 프로젝트는 빌드 과정에 있어서 보통 NPM 기반으로 프로젝트를 구성하고 외부 라이브러리를 설치
- npm 명령어로 라이브러리 설치해서 사용

  ```bash
  npm install jquery
  ```

- NPM 명령어로 설치한 외부 라이브러리는 `node_modules` 폴더에 설치됨

<br>

### 19.7.2. 외부 라이브러리의 타입 선언 파일: Definitely Typed

- 외부 라이브러리를 사용하는 이유는 대부분 미리 잘 구현된 기능들을 가져다 빠르게 개발하기 위해서임
- 그러다보니 라이브러리 내부 로직이 최소 몇십 줄에서 많게는 몇천, 몇만 줄이 되기도 함
- 로직이 모두 자바스크립트로 작성되어 있다면 타입을 직접 하나하나 정의해서 사용하는 것은 거의 불가능함
- 라이브러리 사용자들이 특정 라이브러리에 대한 타입을 정의해서 **Definitely Typed**라는 깃험 리포지터리에 공유해 둠
- 사람들이 많이 사용하는 라이브러리 타입을 누군가가 미리 정의해서 이 리포지터리에 모아 놓음
- **외부 라이브러리의 타입 선언 파일은 NPM 공식 사이트에서 패키지를 검색하여 타입 선언 파일을 지원하는지 확인하고, '@/types/라이브러리이름'으로 패키지가 있는지 확인한 후 프로젝트에 설치해서 사용**

<br>

### 19.7.3. 외부 라이브러리에 내장된 타입 선언 파일

- 외부 라이브러리 자체적으로 타입 정의가 되어 있기도 함
- ex) 대중적인 HTTP 라이브러리인 axios

#### axios

- 클라이언트와 서버 환경에서 모두 사용할 수 있는 HTTP 라이브러리
- 화면에 정보를 표시하려고 데이터를 요청하는 클라이언트나 Node.js 환경에서 작성된 서버용 자바스크립트 코드에서 사용됨
- API 호출 결과가 프로미스(promise)로 되어 있고 개발할 때 참고하기 쉽게 문서화가 잘 되어 있음
- axios 설치

  ```bash
  npm install axios
  ```

- @types.axios처럼 별도의 타입 선언 라이브러리를 추가하지 않고도 타입스크립트 프로젝트에서 바로 사용 가능

<br>

- **타입스크립트 프로젝트에서 외부 라이브러리를 사용할 때는 NPM 공식 사이트 검색으로 타입 선언 파일이 같이 제공되는지 혹은 타입 선언 라이브러리를 별도로 추가해야 하는지 확인 가능**

<br>

### 19.7.4. 외부 라이브러리에 타입 선언 파일이 지원되지 않는 경우

#### 직접 타입을 정의하는 방법

- 라이브러리의 소스 코드를 모두 이해하고 하나하나 작성하는 것이 아니라 **실제로 사용하는 라이브러리의 API나 코드들과 관계된 타입만 먼저 작성해 나가는 방식**

#### 명령어로 타입 선언 파일 생성하기

- 타입 선언 파일을 생성해 주는 명령어를 활용하는 방식
- 대상 라이브러리의 규모가 작고 간단할 때 사용하면 좋음
