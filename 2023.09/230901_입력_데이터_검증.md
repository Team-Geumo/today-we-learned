### 입력 데이터 검증

- 개념
  
  - 입력 데이터로 인해 발생하는 문제를 예방하기 위해 구현 단계에서 검증해야 하는 보안 점검 항목
  
  - 소프트웨어 개발의 구현 단계에서 유효성 검증 체계를 갖추고, 검증되지 않은 데이터의 입력을 처리할 수 있도록 구현해야 함

- 취약점
  
  - XSS (Cross Site Scripting)
    
    - 개념
      
      - 검증되지 않은 외부 입력 데이터가 포함된 웹페이지가 전송되는 경우, 사용자가 해당 웹페이지를 열람함으로써 웹페이지에 포함된 부적절한 스크립트가 실행되는 공격
    
    - 대책
      
      - 특수문자 등록을 방지하기 위해 특수문자 필터링
      
      - HTML 태그 사용 금지
        
        - 특히 `<` 문자 사용 시 `&lt`로 변환처리
    
    - 공격 유형
      
      - Stored XSS
        
        - 방문자들이 악성 스크립트가 포함된 페이지를 읽어 봄과 동시에 악성 스크립트가 브라우저에서 실행되면서 감염되는 기법
      
      - Reflected XSS
        
        - 공격용 악성 URL을 생성한 후 이메일로 사용자에게 전송하면 사용자가 URL 클릭 시 공격 스크립트가 피해자로 반사되어 접속 사이트의 민감정보를 공격자에게 전송하는 기법
      
      - DOM (Document Object Model) XSS
        
        - 공격자는 DOM 기반 XSS 취약점이 있는 브라우저를 대상으로 조작된 URL을 이메일을 통해 발송하고 피해자가 URL 클릭 시 공격 피해를 당하는 기법
    
    - 공격 방식
      
      - 임의의 XSS 취약점이 존재하는 서버에 XSS 코드를 작성하여 삽입 저장
  
  - SQL 삽입 (Injection)
    
    - 개념
      
      - 응용 프로그램의 보안 취약점을 이용해 악의적인 SQL 구문을 삽입, 실행히켜 DB의 접근을 통해 정보를 탈취하거나 조작하는 공격기법
    
    - 대책
      
      - 바인딩 매개변수 방식을 적용하여 사전에 변수 타입을 명시적으로 지정
      
      - 사용자로부터 입력될 수 있는 모든 값을 체크하여 필터링
      
      - Java의 경우 Servlet Filter 기능 적용
    
    - 공격 유형
      
      - Form SQL Injection
        
        - HTML Form 기반 인증을 담당하는 애플리케이션의 취약점이 있는 경우 사용자 인증을 위한 쿼리 문의 조건을 임의로 조작하여 인증을 우회하는 기법
      
      - Union SQL Injection
        
        - 쿼리의 UNION 연산자를 이용하여 한 쿼리의 결과를 다른 쿼리의 결과에 결합하여 공격하는 기법
      
      - Stored Procedure SQL Injection
        
        - Stored Procedure를 이용하여 공격하는 기법
      
      - Mass SQL Injection
        
        - 기존 SQL Injection의 확장된 개념으로 한 번의 공격으로 대량의 DB 값이 변조되어 홈페이지에 치명적인 영향을 미치는 공격기법
      
      - Error-Based SQL Injection
        
        - DB 쿼리에 대한 에러값을 기반으로 한 단계씩 점진적으로 DB 정보를 획득할 수 있는 공격기법
        
        - DB 쿼리에 대한 오류 메시지를 반환하지 않으면 공격할 수 없음
      
      - Blind SQL Injection
        
        - 오류 메시지가 아닌 쿼리 결과의 참과 거짓을 통해 의도하지 않은 SQL문을 실행함으로써 DB를 비정상적으로 공격하는 기법
    
    - 공격 방식
      
      - 응용 프로그램의 취약점 탐지
      
      - 악의적인 SQL 구문 삽입하여 인증 우회
      
      - 권한이 상승되어 DB의 정보 탈취 및 조작 실행
  
  - CSRF (Cross Site Request Forgery; 사이트 간 요청 위조)
    
    - 개념
      
      - 사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위를 특정 웹사이트에 요청하게 하는 공격
    
    - 대책
      
      - 입력화면 폼을 작성 시 GET 방식보다 POST 방식 사용
      
      - 입력 폼과 입력처리 프로그램에서 세션별 CSRF 토큰을 사용하여 점검
      
      - 중요 기능의 경우 재인증을 통해 안전하게 실제 요청 여부를 확인하도록 구현
    
    - 공격 방식
      
      - 공격자가 CSRF 스크립트가 포함된 게시물을 등록
      
      - 사용자는 CSRF 스크립트가 포함된 페이지의 게시물 열람 요청
      
      - 게시물을 읽은 사용자의 권한으로 공격자가 원하는 요청 발생
      
      - 공격자가 원하는 CSRF 스크립트 결과 발생
  
  - 코드 삽입
  
  - 경로 조작 및 자원 삽입
  
  - 서버 사이드 요청 위조
  
  - 운영체제 명령어 삽입