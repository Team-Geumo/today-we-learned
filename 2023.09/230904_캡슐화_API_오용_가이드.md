### 캡슐화

- 개념
  
  - 외부에 은닉이 필요한 중요한 데이터와 필요한 기능성을 불충분하게 캡슐화했을 때 인가되지 않은 사용자에게 데이터 유출, 권한 문제 등이 발생할 수 있는 보안 취약점 예방을 위한 보안 검증 항목

- 취약점
  
  - 잘못된 세션에 의한 데이터 정보 노출
    
    - 다중 스레드 환경에서 싱글톤 객체 필드에서 경쟁 조건으로 인해 동기화 오류가 발생하거나 멤버 변수의 정보가 노출되는 보안 취약점
    
    - 대책
      
      - 싱글톤 패턴을 사용하는 경우 변수 범위에 주의하고, 멤버 변수보다 지역 변수를 활용하여 변수의 범위를 제한
  
  - 제거되지 않고 남은 디버그 코드
    
    - 대책
      
      - 디버거 코드는 개발 완료 후, 삭제 처리
  
  - 민감한 데이터를 가진 내부 클래스 사용
    
    - 권한이 없는 클래스를 사용하고자 할 때 발생하는 취약점
    
    - 대책
      
      - 내부 클래스 사용 시 외부 클래스의 접근 금지
  
  - 시스템 데이터 정보 노출
    
    - 시스템의 내부 데이터를 시스템 메시지 등을 통해 외부로 출력하도록 코딩했을 때 발생하는 보안 취약점
    
    - 대책
      
      - 시스템 메시지를 통해 노출되는 메시지는 최소한의 정보만 제공함으로써 방지

### API 오용

- 개념
  
  - 서비스에서 제공되는 이용에 반하는 방법
  
  - API를 이용하거나 보안에 취약한 API를 오용하여 발생할 수 있는 보안 취약점 예방을 위한 보안 검증 항목

- 취약점
  
  - DNS Lookup에 의존한 보안 결정
    
    - 도메인명에 의존하여 인증이나 접근 통제 등의 보안 결정을 내리는 경우 발생하는 보안 약점
    
    - DNS 엔트리를 속여 동일한 도메인에 속한 서버인 것처럼 위장하거나, 사용자와 서버 간의 네트워크 트래픽을 유도하여 악성 사이트를 경유하도록 조작할 수 있음
    
    - 대책
      
      - 보안 결정에서 도메인명을 이용한 DNS Lookup을 하지 않도록 함
      
      - **DNS 이름 검색 함수를 사용한 후 조건문에서 인증 여부를 수행하는 것보다 IP 주소를 이용**하는 것이 DNS 이름을 직접 사용하는 것보다 안전
  
  - 위험하다고 알려진 함수 사용
    
    - 예
      
      - strcpy 함수
        
        - 글자 수 관계없이 문자열 복사 가능
    
    - 대책
      
      - strncpy 함수
        
        - 문자열 복사 시 글자 길이 지정
  
  - 널 매개변수 미검사
    
    - 자바 표준에서 특정 메서드 사용 시 매개변수가 널인 경우 지정된 값을 반환하지 못해 발생하는 동작에 대한 보안 취약점
    
    - 대책
      
      - 널 여부를 점검하는 과정을 거친 후 사용해야 함