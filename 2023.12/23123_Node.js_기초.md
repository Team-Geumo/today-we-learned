## 1. 노드의 정의

### 1. 노드의 정의

#### 공식 홈페이지의 설명

크롬 V8 자바스크립트 엔진으로 빌드된 자바스크립트 런타임

-   cf) 타입스크립트 런타임은 디노

런타임 === 실행기

#### 노드 이전 / 이후 비교

노드가 나오기 이전 : HTML이 없으면자바스크립트를 실행할 수 없었음

노드가 나온 이후 : HTML이 없어도 자바스크립트를 실행할 수 있음

-   === 브라우저나 HTML의 종속성에서 벗어나 독립적으로 실행할 수 있게 됨

#### 노드는 서버가 아닌가요?

서버의 역할도 수행할 수 있는 자바스크립트 런타임

### 2. 내부 구조

#### 내부 구조

내부는 C 혹은 C++로 구성되어 있음

노드는 **V8**과 **libuv**를 내부적으로 포함함

-   비동기 & 싱글스레드 모델 : 프로그래밍 난이도가 쉬움

## 2. 노드의 특징

### 1. 이벤트 기반

이벤트가 발생할 때 미리 지정한 작업을 수행하는 방식

-   이벤트 리스너 : 이벤트를 등록하는 함수
-   콜백 함수 : 이벤트가 발생했을 때 실행될 함수

### 2. 논블로킹 I/O

#### 논블로킹

오래 걸리는 함수를 백그라운드로 보내서 다음 코드가 먼저 실행되게 하고, 나중에 오래 걸리는 함수를 실행하는 방식

노드의 경우 **블로킹-동기** / **논블로킹-비동기** 두 가지 경우만 있다고 생각

#### 블로킹 / 논블로킹

**블로킹** : 코드가 순서대로 실행됨

-   대부분의 코드는 블로킹 방식으로 실행

**논블로킹** : 코드가 순서대로 실행되지 않음 (규칙은 있음)

-   일부 코드의 경우 논블로킹 방식으로 실행
-   I/O 작업(파일 시스템 접근, 네트워크 요청), 압축, 암호화 등

### 3. 프로세스 vs 스레드

#### 프로세스와 스레드

**프로세스** : 운영체제에서 할당되는 작업의 단위, 프로세스 간 자원 공유 X

**스레드** : 프로세스 내에서 실행되는 작업의 단위, 부모 프로세스의 자원 공유

노드는 **멀티 스레드지만** 직접 다룰 수 있는 스레드는 하나이기 때문에 **싱글 스레드라고 표현함**

-   만약 실제로 싱글 스레드였다면 논블로킹 방식 사용 불가능 (동시에 돌아갈 수 없어서)
-   14버전부터 멀티 스레드 사용 가능

### 4. 싱글 스레드

#### 주방에 비유해보기

점원 (스레드), 주문(요청), 서빙(응답)

#### 싱글 스레드 - 블로킹 모델

싱글 스레드만 사용한다면 주어진 일을 하나밖에 처리하지 못함

-   블로킹이 발생하는 경우 나머지 작업은 모두 대기 > 비효율 발생

#### 싱글 스레드 - 논블로킹 모델 (노드)

논블로킹 모델을 채택해 일부 코드(I/O)를 백그라운드(다른 프로세스)에서 실행 가능

-   여러 요청을 먼저 받은 후, 완료될 때 응답함
-   I/O 관련 코드가 아닌 경우 싱글 스레드 - 블로킹 모델과 같아짐

### 5. 멀티 스레드와 비교

**싱글 스레드 모델** : 에러를 처리하지 못하는 경우 멈춤

-   프로그래밍 난이도 쉬움
-   CPU, 메모리 자원을 적게 사용

**멀티 스레드 모델** : 에러 발생 시 새로운 스레드를 생성해 극복

-   단, 새로운 스레드 생성이나 놀고 있는 스레드 처리에 비용 발생
-   프로그래밍 난이도 어려움
-   스레드 수만큼 자원을 많이 사용함

### 6. 멀티 스레드의 활용

#### 노드 14버전

멀티 스레드를 사용할 수 있도록 `worker_threads` 모듈 도입

CPU를 많이 사용하는 작업인 경우에 활용 가능

멀티 프로세싱만 가능했던 아쉬움을 달래줌

#### 멀티 스레딩과 멀티 프로세싱 비교

![[Pasted image 20231213214230.png]]
